/**
 * Base Page Object
 * Abstract base class for all page objects with common functionality
 *
 * Generated by: create-e2e-docker
 */

import { Page, Locator, expect } from "@playwright/test";

export abstract class BasePage {
  protected readonly page: Page;
  protected readonly path: string;

  constructor(page: Page, path: string) {
    this.page = page;
    this.path = path;
  }

  /**
   * Navigate to this page
   */
  async navigate(): Promise<void> {
    await this.page.goto(this.path);
    await this.waitForLoad();
  }

  /**
   * Wait for page to be fully loaded
   */
  async waitForLoad(): Promise<void> {
    await this.page.waitForLoadState("networkidle");
  }

  /**
   * Wait for URL to match pattern
   */
  async waitForURL(pattern: RegExp | string): Promise<void> {
    await this.page.waitForURL(pattern, { timeout: 30000 });
  }

  /**
   * Take a screenshot
   */
  async takeScreenshot(name: string): Promise<void> {
    await this.page.screenshot({
      path: `<%= testing.reportDir %>/screenshots/${name}.png`,
      fullPage: true,
    });
  }

  /**
   * Get a locator by CSS selector
   */
  protected locator(selector: string): Locator {
    return this.page.locator(selector);
  }

  /**
   * Get a locator by test ID
   */
  protected getByTestId(testId: string): Locator {
    return this.page.getByTestId(testId);
  }

  /**
   * Check if text is visible on page
   */
  async hasText(text: string | RegExp): Promise<boolean> {
    return this.page.getByText(text).isVisible();
  }

  /**
   * Assert that a locator is visible
   */
  async expectVisible(locator: Locator): Promise<void> {
    await expect(locator).toBeVisible();
  }

  /**
   * Assert that a locator is not visible
   */
  async expectNotVisible(locator: Locator): Promise<void> {
    await expect(locator).not.toBeVisible();
  }

  /**
   * Get current URL
   */
  getURL(): string {
    return this.page.url();
  }

  /**
   * Check if currently on this page
   */
  isOnPage(): boolean {
    return this.page.url().includes(this.path);
  }
}
